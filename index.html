<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
        Programación avanzada TV
    </title>
    <style type="text/css">
        body{
            background-color: gray;
        }
        .my-class  {
            overflow: auto;
            width: 100%;
        }
        .my-class table {
            border: 1px solid #38571A;
            height: 100%;
            width: 100%;
            table-layout: fixed;
            border-collapse: collapse;
            border-spacing: 1px;
            text-align: left;
        }
        .my-class caption {
            caption-side: top;
            text-align: left;
        }
        .my-class th {
            border: 1px solid #38571A;
            background-color: #ECEFF1;
            color: #2C1376;
            padding: 5px;
        }
        .my-class td {
            border: 1px solid #38571A;
            background-color: #FFFFFF;
            color: #0042AA;
            padding: 5px;
        }
    </style>
</head>
<body>

    <div class="container" id="container_app">
        
        <form v-if="!access">
            
            <fieldset>
                <legend>
                    Email
                </legend>
                <input type="email" v-model="email" placeholder="Write here" name="">
            </fieldset>

            <fieldset>
                <legend>
                    Password
                </legend>
                <input type="password" v-model="password" placeholder="Write here" name="">
            </fieldset>

            <button @click="login" type="button">
                Access
            </button>

        </form>

         
        <div v-if="access" class="my-class" role="region" tabindex="0">
            <table>
                <caption>
                    Lista de usuarios
                </caption>
                <thead>
                <tr>
                    <th>
                        Personal Data
                    </th>
                    <th>
                        Contact Data
                    </th>
                    <th>
                        Address
                    </th>
                    <th>
                        Company Data
                    </th>
                </tr>
                </thead>
                <tbody>
                    <tr v-for="u in users">
                        <td>
                            {{ u.name }}, {{ u.username }}
                        </td>
                        <td>
                            {{ u.email }}, {{ u.phone }}
                        </td>
                        <td>
                            {{ u.address.street }}, {{ u.address.zipcode }}
                        </td>
                        <td>
                            {{ u.company.name }}
                        </td>
                    </tr>  
                </tbody>
            </table> 
        </div>

        <!-- 1.- creamos el form -->
        <!-- <form>
            
            <fieldset>
                <legend>
                    Name(s):
                </legend>
                <input type="" v-model="name" placeholder="Write Here" name="">
            </fieldset>

            <fieldset>
                <legend>
                    Lastname(s):
                </legend>
                <input type="" v-model="lastname" placeholder="Write Here" name="">
            </fieldset>

            <button type="button" v-on:click="saveData">
                Save
            </button>
        </form> 

        <ol>
            <li v-for="k in persons">
                {{ k.nombre }}  {{ k.apellido }}
            </li>
        </ol>

        <hr>

        <button @click="count++" > 

            Click me {{ count }}

        </button>

        <br>

        <h1>
            Hola {{ username }}
        </h1>

        <input type="" v-model="username" name="">

        <br>

        <input type="" v-model="num1" name="">
        <input type="" v-model="num2" name="">

        <button @click="hi"> 
            Sumar
        </button>

        <h1 v-if="result!=0">
            Resultado: {{ result }}
        </h1> -->

    </div>
    
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script type="text/javascript">

        const { createApp, ref, useAsyncState, useFetch} = Vue

        createApp({ 
            setup(){

                email = ref('Sincere@april.biz'), password = ref('1234')
                users = ref([])

                access = ref(localStorage.getItem('is_login') ?? false);

                return {
                    email, 
                    password,
                    access,
                    users
                }
            }, 

            async mounted(){
                
                const update = async () =>{
                    
                    const response = await fetch("users.json");
                    this.users = await response.json();

                } 

                if (this.access) {
                    update();
                } 
            }, 

             

            methods:{
                async login(){

                    const response = await fetch("users.json");
                    this.users = await response.json();
                     

                    this.users.forEach((user) => {

                        if (this.email == user.email) {
                            if (this.password == user.password) {

                                alert("Bienvenido "+ user.name)
                                
                                localStorage.setItem('is_login',true);
                                localStorage.setItem("user_data", JSON.stringify(user));

                                this.access = true;
                            }
                        }
                    })

                    if(!this.access){
                        alert("Verifique su información")
                    }

                }
                
            } 
        }).mount("#container_app")
        
        // const { createApp, ref } = Vue

        // createApp({ 
        //     setup(){

        //         const username = ref('')
        //         const num1 = ref(0)
        //         const num2 = ref(0)
        //         const result = ref(0)

        //         // 4.- Crear variables
        //         return {
        //             count: ref(0),
        //             username,
        //             num1,
        //             num2,
        //             result,
        //             name: ref(''),
        //             lastname: ref(''),
        //             persons: ref([])
        //         }
        //     },
        //     methods:{
        //         hi(){
        //             this.result = (+this.num1) + (+this.num2)
        //         },
        //         // 2.- nuevo método
        //         saveData(){
        //             console.log("Hola")

        //             //5.- crear objeto
        //             let p = { 
        //                 nombre:this.name,
        //                 apellido:this.lastname
        //             };

        //             //6.- Guardarlo en un arreglo
        //             this.persons.push(p)
        //         }
        //     } 
        // }).mount("#container_app")


    </script>
</body>
</html>